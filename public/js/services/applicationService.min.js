"use strict";define(["app"],function(app){app.service("applicationService",["$http","webSocketService",function($http,webSocketService){var that=this;this.hasExam=false;this.examStatus=null;this.setExamStatus=function(status){this.examStatus=status};this.getExamStatus=function(){return this.examStatus};this.trainStatus=null;this.setTrainStatus=function(status){this.trainStatus=status};this.getTrainStatus=function(){return this.trainStatus};this.qcprStatus=null;this.setQcprStatus=function(status){this.qcprStatus=status};this.getQcprStatus=function(status){return this.qcprStatus};this.scoreInfo=null;this.setScoreInfo=function(scoreInfo){this.scoreInfo=scoreInfo};this.getScoreInfo=function(){return this.scoreInfo};this.mbWidth=null;this.setMbWidth=function(mbWidth){this.mbWidth=mbWidth};this.getMbWidth=function(){return this.mbWidth};this.mbHeight=null;this.setMbHeight=function(mbHeight){this.mbHeight=mbHeight};this.getMbHeight=function(){return this.mbHeight};this.kickStatus=null;this.setKickStatus=function(kickStatus){this.kickStatus=kickStatus};this.getKickStatus=function(){return this.kickStatus};this.mbOrientation=null;this.setMbOrientation=function(mbOrientation){this.mbOrientation=mbOrientation};this.getMbOrientation=function(){return this.mbOrientation};this.pageType=null;this.setPageType=function(pageType){this.pageType=pageType};this.getPageType=function(){return this.pageType};this.user=null;this.setUser=function(user){this.user=user};this.getUser=function(){return this.user};this.examIndex=null;this.setExamIndex=function(examIndex){this.examIndex=examIndex};this.getExamIndex=function(){return this.examIndex};this.login=function(param,fn){$http({method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},cache:false,timeout:30000,data:JSON.stringify(param),url:"../api/v1/user.login"}).then(function(response){fn(response.data.code,response.data.message)},function(response){fn(response.status,response.statusText)})};this.register=function(param,fn){$http({method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},cache:false,timeout:30000,data:JSON.stringify(param),url:"../api/v1/user.register"}).then(function(response){fn(response.data.code,response.data.message)},function(response){fn(response.status,response.statusText)})};this.logout=function(fn){if(this.getUser()==null){throw new Error("登录帐号已退出.")}var userAccount=this.getUser().userAccount;var pageType=this.getPageType();var param={};param.userAccount=userAccount;param.pageType=pageType;$http({method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},cache:false,timeout:30000,data:JSON.stringify(param),url:"../api/v1/user.logout"}).then(function(response){that.setUser(null);that.setPageType(0);var data=response.data;var code=data.code;var message=data.message;fn(code,message)},function(response){fn(response.status,response.statusText)})};this.exit=function(){if(this.getUser()==null){throw new Error("登录帐号已退出.")}var userAccount=this.getUser().userAccount;var pageType=this.getPageType();var param={};param.userAccount=userAccount;param.pageType=pageType;$.ajax({method:"POST",contentType:"application/json",cache:false,async:false,timeout:30000,data:JSON.stringify(param),url:"../api/v1/user.logout",success:function(){webSocketService.webSocket.close();webSocketService.webSocket=null}})};this.getScoreStandard=function(fn){$http({method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},cache:false,timeout:30000,url:"../api/v1/operation.get"}).then(function(response){fn(response.data.code,response.data.message)},function(response){fn(response.status,response.statusText)})};this.getScore=function(param,fn){$http({method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},cache:false,timeout:30000,data:JSON.stringify(param),url:"../api/v1/score.get"}).then(function(response){fn(response.data.code,response.data.message)},function(response){fn(response.status,response.statusText)})};this.robotRebuild=function(param,fn){$http({method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},cache:false,timeout:30000,data:JSON.stringify(param),url:"../api/v1/robot.rebuild"}).then(function(response){fn(response.data.code,response.data.message)},function(response){fn(response.status,response.statusText)})};this.checkBrowers=function(){var browser={versions:function(){var u=navigator.userAgent,app=navigator.appVersion;return{trident:u.indexOf("Trident")>-1,presto:u.indexOf("Presto")>-1,webKit:u.indexOf("AppleWebKit")>-1,gecko:u.indexOf("Gecko")>-1&&u.indexOf("KHTML")==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf("Android")>-1||u.indexOf("Linux")>-1,iPhone:u.indexOf("iPhone")>-1,iPad:u.indexOf("iPad")>-1,webApp:u.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};if(browser.versions.mobile){var ua=navigator.userAgent.toLowerCase();if(ua.match(/MicroMessenger/i)=="micromessenger"){WeixinJSBridge.call("hideOptionMenu");
WeixinJSBridge.call("hideToolbar")}}return false}}])});